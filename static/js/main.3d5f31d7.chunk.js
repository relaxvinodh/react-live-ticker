(this["webpackJsonpreact-live-tracker"]=this["webpackJsonpreact-live-tracker"]||[]).push([[0],{37:function(a,t,e){},38:function(a,t,e){},39:function(a,t,e){},40:function(a,t,e){},41:function(a,t,e){},42:function(a,t,e){"use strict";e.r(t);var n=e(1),c=e(4),s=e.n(c),r=e(27),i=e.n(r),o=(e(37),e(8)),l=(e(38),e(39),function(){return Object(n.jsxs)("div",{className:"header",children:["Order Book"," ",Object(n.jsx)("span",{className:"subText",children:" BTC/USD"})]})}),d=e(52),u=e(54),b=e(30),j=e(44),x=e(45),O=e(55),v=e(51),p=e(46),S=e(47),h=e(56),f={INITIAL:"INITIAL",UPDATE_ASKS:"UPDATE_ASKS",DELETE_ASKS:"DELETE_ASKS",UPDATE_BIDS:"UPDATE_BIDS",DELETE_BIDS:"DELETE_BIDS"},m=e(53),E=e(43),k=e(50),M=e(28),D=e(23),T=e(31),A=e(29),I=e(19),N=m.a({price:E.a(k.a(0)),count:E.a(k.a(1)),amount:E.a(k.a(2))}),g=M.a,y=d.a(g,D.a(T.a("total")),A.a(Math.max)),L=function(a,t){return a.reduce((function(a,e,n,c){void 0===a[e]&&(a[e]={});var s=t[e].amount,r=(a[c[n-1]]||{}).total,i=void 0===r?0:r;return a[e]={amount:s,total:parseFloat((i+s).toFixed(8))},a}),{})},_={asks:{data:{},priceSnap:[],totals:{},totalMax:0},bids:{data:{},priceSnap:[],totals:{},totalMax:0}},B=function(a,t){var e=Object(o.a)(t,2),n=e[0],c=e[1];switch(n){case f.INITIAL:var s=function(a,t){return I.a((function(a,t){var e=Object(o.a)(t,3),n=e[0],c=e[2]>=0?"bids":"asks";return void 0===a[c].data[n]&&(a[c].data[n]={}),a[c].priceSnap.push(n),a[c].data[n]=N(t),a}),t,a)}(c,a),r=L(a.asks.priceSnap,a.asks.data),i=L(a.bids.priceSnap,a.bids.data),l=Math.max(y(r),y(i));return d.a(u.a(["asks","totals"],r),u.a(["asks","totalMax"],l),u.a(["bids","totalMax"],l),u.a(["bids","totals"],i))(s);case f.UPDATE_ASKS:var m=c,E=Object(o.a)(m,1)[0],k=b.a(String(E),N(c),a.asks.data),M=j.a(x.a(E),O.a,d.a(v.a([E]),p.a((function(a,t){return a-t}))))(a.asks.priceSnap),D=L(M,k),T=Math.max(y(D),a.bids.totalMax);return d.a(u.a(["asks","data"],k),u.a(["asks","priceSnap"],M),u.a(["asks","totals"],D),u.a(["asks","totalMax"],T))(a);case f.DELETE_ASKS:var A=c,g=Object(o.a)(A,1)[0],_=S.a(String(g),a.asks.data),B=h.a([g],a.asks.priceSnap),w=L(B,_),P=Math.max(y(w),a.bids.totalMax);return d.a(u.a(["asks","data"],_),u.a(["asks","priceSnap"],B),u.a(["asks","totals"],w),u.a(["asks","totalMax"],P))(a);case f.UPDATE_BIDS:var C=c,U=Object(o.a)(C,1)[0],K=b.a(String(U),N(c),a.bids.data),F=j.a(x.a(U),O.a,d.a(v.a([U]),p.a((function(a,t){return t-a}))))(a.bids.priceSnap),J=L(F,K),R=Math.max(y(J),a.asks.totalMax);return d.a(u.a(["bids","data"],K),u.a(["bids","priceSnap"],F),u.a(["bids","totals"],J),u.a(["bids","totalMax"],R))(a);case f.DELETE_BIDS:var H=c,W=Object(o.a)(H,1)[0],q=S.a(String(W),a.bids.data),z=h.a([W],a.bids.priceSnap),G=L(z,q),Q=Math.max(y(G),a.asks.totalMax);return d.a(u.a(["bids","data"],q),u.a(["bids","priceSnap"],z),u.a(["bids","totals"],G),u.a(["bids","totalMax"],Q))(a);default:return a}},w=e(17),P=e(22),C=e(49),U=Object(c.createContext)(null),K=e(48),F=(e(40),s.a.memo((function(a){var t=a.value,e=a.totalMax,s=Object(P.a)(a,["value","totalMax"]),r=Object(c.useMemo)((function(){return"".concat(100*Math.abs(t)/e,"%")}),[t,e]);return Object(n.jsx)("rect",Object(w.a)(Object(w.a)({},s),{},{width:r}))}))),J=s.a.memo((function(a){var t=a.type,e=Object(c.useContext)(U)[t],s=e.totals,r=e.totalMax,i=Object(c.useMemo)((function(){return"bids"===t?p.a(K.a(T.a("total")),M.a(s)):M.a(s)}),[s,t]);return Object(n.jsx)("div",{className:"chart container",children:Object(n.jsx)("svg",{className:t,children:null===i||void 0===i?void 0:i.map((function(a,e){var c=a.total;return Object(n.jsx)(F,{x:"1",y:17*e,height:"17",value:c,totalMax:r,fillOpacity:"1"},"".concat(t,"-").concat(e))}))})})})),R=(e(41),function(a){var t=a.children;return Object(n.jsx)("div",{className:"tableBody",children:t})}),H=function(a){var t=a.children,e={"--ratio":a.ratio};return Object(n.jsx)("div",{className:"tableField",style:e,children:t})},W=function(a){var t=a.children;return Object(n.jsx)("div",{className:"tableHeader",children:t})},q=function(a){var t=a.children;return Object(n.jsx)("p",{className:"tableLabel",children:t})},z=function(a){var t=a.children;return Object(n.jsx)("div",{className:"tableRow",children:t})},G=s.a.memo((function(a){var t=a.item,e=a.total;return Object(n.jsxs)(z,{children:[Object(n.jsxs)(H,{children:[Object(n.jsx)(q,{children:"Count"}),null===t||void 0===t?void 0:t.count]}),Object(n.jsxs)(H,{children:[Object(n.jsx)(q,{children:"Amount"}),(null===t||void 0===t?void 0:t.amount)&&Math.abs(t.amount)]}),Object(n.jsxs)(H,{children:[Object(n.jsx)(q,{children:"Total"}),e&&Math.abs(e)]}),Object(n.jsxs)(H,{children:[Object(n.jsx)(q,{children:"Price"}),null===t||void 0===t?void 0:t.price]})]})})),Q=s.a.memo((function(a){var t=a.type,e=Object(P.a)(a,["type"]),s=Object(c.useContext)(U)[t],r=s.data,i=s.totals,o=Object(c.useMemo)((function(){return"bids"===t?p.a(C.a(T.a("price")),M.a(r)):M.a(r)}),[r,t]);return Object(n.jsxs)("div",Object(w.a)(Object(w.a)({className:"table ".concat(null!==t&&void 0!==t?t:"")},e),{},{children:[Object(n.jsx)(W,{children:Object(n.jsx)(G,{})}),Object(n.jsxs)(R,{children:[Object(n.jsx)(J,{type:t}),o.map((function(a,e){return Object(n.jsx)(G,{item:a,total:i[a.price].total},"".concat(t,"-").concat(e))}))]})]}))})),V=function(){return Object(n.jsxs)("div",{className:"tableContainer",children:[Object(n.jsx)(Q,{type:"bids"}),Object(n.jsx)(Q,{type:"asks"})]})},X=function(){var a=localStorage.getItem("booksStore"),t=Object(c.useReducer)(B,a?JSON.parse(a):_),e=Object(o.a)(t,2),s=e[0],r=e[1],i=Object(c.useCallback)((function(){return localStorage.setItem("booksStore",JSON.stringify(s))}),[s]);return Object(c.useEffect)((function(){var a=new WebSocket("wss://api-pub.bitfinex.com/ws/2");return a.onopen=function(){a.send(JSON.stringify({event:"subscribe",channel:"book",symbol:"tBTCUSD"}))},a.onmessage=function(a){var t=a.data,e=JSON.parse(t);if(!e.event)if(e[1]&&e[1][0]&&Array.isArray(e[1][0]))r([f.INITIAL,e[1]]);else{var n=Object(o.a)(e[1],3),c=n[1],s=n[2];r(c>0?[s>0?f.UPDATE_BIDS:f.UPDATE_ASKS,e[1]]:[s>0?f.DELETE_BIDS:f.DELETE_ASKS,e[1]])}},setTimeout((function(){return a.close()}),5e3),window.addEventListener("unload",i,!1),function(){try{window.removeEventListener("unload",i,!1),a.close()}catch(t){console.error(t,"error in closing websocket")}}}),[]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(l,{}),Object(n.jsx)(U.Provider,{value:s,children:Object(n.jsx)(V,{})})]})},Y=function(a){a&&a instanceof Function&&e.e(3).then(e.bind(null,57)).then((function(t){var e=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;e(a),n(a),c(a),s(a),r(a)}))};i.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(X,{})}),document.getElementById("root")),Y()}},[[42,1,2]]]);
//# sourceMappingURL=main.3d5f31d7.chunk.js.map