(this["webpackJsonpreact-live-tracker"]=this["webpackJsonpreact-live-tracker"]||[]).push([[0],{27:function(a,t,e){},38:function(a,t,e){},39:function(a,t,e){},40:function(a,t,e){},41:function(a,t,e){},42:function(a,t,e){"use strict";e.r(t);var n=e(1),c=e(4),s=e.n(c),r=e(28),i=e.n(r),o=(e(38),e(27),e(39),function(){return Object(n.jsxs)("div",{className:"header",children:["Order Book"," ",Object(n.jsx)("span",{className:"subText",children:" BTC/USD"})]})}),l=e(17),d=e(22),u=e(43),b=e(45),j=e(32),x=e(29),O=Object(c.createContext)(null),v=e(44),p=(e(40),s.a.memo((function(a){var t=a.value,e=a.totalMax,s=Object(d.a)(a,["value","totalMax"]),r=Object(c.useMemo)((function(){return"".concat(100*Math.abs(t)/e,"%")}),[t,e]);return Object(n.jsx)("rect",Object(l.a)(Object(l.a)({},s),{},{width:r}))}))),S=s.a.memo((function(a){var t=a.type,e=Object(c.useContext)(O)[t],s=e.totals,r=e.totalMax,i=Object(c.useMemo)((function(){return"bids"===t?u.a(v.a(j.a("total")),x.a(s)):x.a(s)}),[s,t]);return Object(n.jsx)("div",{className:"chart container",children:Object(n.jsx)("svg",{className:t,children:null===i||void 0===i?void 0:i.map((function(a,e){var c=a.total;return Object(n.jsx)(p,{x:"1",y:17*e,height:"17",value:c,totalMax:r,fillOpacity:"1"},"".concat(t,"-").concat(e))}))})})})),h=(e(41),function(a){var t=a.children;return Object(n.jsx)("div",{className:"tableBody",children:t})}),f=function(a){var t=a.children,e={"--ratio":a.ratio};return Object(n.jsx)("div",{className:"tableField",style:e,children:t})},m=function(a){var t=a.children;return Object(n.jsx)("div",{className:"tableHeader",children:t})},E=function(a){var t=a.children;return Object(n.jsx)("p",{className:"tableLabel",children:t})},k=function(a){var t=a.children;return Object(n.jsx)("div",{className:"tableRow",children:t})},M=s.a.memo((function(a){var t=a.item,e=a.total;return Object(n.jsxs)(k,{children:[Object(n.jsxs)(f,{children:[Object(n.jsx)(E,{children:"Count"}),null===t||void 0===t?void 0:t.count]}),Object(n.jsxs)(f,{children:[Object(n.jsx)(E,{children:"Amount"}),(null===t||void 0===t?void 0:t.amount)&&Math.abs(t.amount)]}),Object(n.jsxs)(f,{children:[Object(n.jsx)(E,{children:"Total"}),e&&Math.abs(e)]}),Object(n.jsxs)(f,{children:[Object(n.jsx)(E,{children:"Price"}),null===t||void 0===t?void 0:t.price]})]})})),T=s.a.memo((function(a){var t=a.type,e=Object(d.a)(a,["type"]),s=Object(c.useContext)(O)[t],r=s.data,i=s.totals,o=Object(c.useMemo)((function(){return"bids"===t?u.a(b.a(j.a("price")),x.a(r)):x.a(r)}),[r,t]);return Object(n.jsxs)("div",Object(l.a)(Object(l.a)({className:"table ".concat(null!==t&&void 0!==t?t:"")},e),{},{children:[Object(n.jsx)(m,{children:Object(n.jsx)(M,{})}),Object(n.jsxs)(h,{children:[Object(n.jsx)(S,{type:t}),o.map((function(a,e){var c;return Object(n.jsx)(M,{item:a,total:null===(c=i[a.price])||void 0===c?void 0:c.total},"".concat(t,"-").concat(e))}))]})]}))})),D=function(){return Object(n.jsxs)("div",{className:"tableContainer",children:[Object(n.jsx)(T,{type:"bids"}),Object(n.jsx)(T,{type:"asks"})]})},A=e(8),I=e(52),N=e(54),g=e(31),y=e(47),L=e(48),_=e(55),B=e(51),w=e(49),P=e(56),C={INITIAL:"INITIAL",UPDATE_ASKS:"UPDATE_ASKS",DELETE_ASKS:"DELETE_ASKS",UPDATE_BIDS:"UPDATE_BIDS",DELETE_BIDS:"DELETE_BIDS"},U=e(53),K=e(46),F=e(50),J=e(23),R=e(30),H=e(20),W=U.a({price:K.a(F.a(0)),count:K.a(F.a(1)),amount:K.a(F.a(2))}),q=x.a,z=I.a(q,J.a(j.a("total")),R.a(Math.max)),G=function(a,t){return a.reduce((function(a,e,n,c){void 0===a[e]&&(a[e]={});var s=t[e].amount,r=(a[c[n-1]]||{}).total,i=void 0===r?0:r;return a[e]={amount:s,total:parseFloat((i+s).toFixed(8))},a}),{})},Q={asks:{data:{},priceSnap:[],totals:{},totalMax:0},bids:{data:{},priceSnap:[],totals:{},totalMax:0}},V=function(a,t){var e=Object(A.a)(t,2),n=e[0],c=e[1];switch(n){case C.INITIAL:var s=function(a,t){return H.a((function(a,t){var e=Object(A.a)(t,3),n=e[0],c=e[2]>=0?"bids":"asks";return void 0===a[c].data[n]&&(a[c].data[n]={}),a[c].priceSnap.push(n),a[c].data[n]=W(t),a}),t,a)}(c,a),r=G(a.asks.priceSnap,a.asks.data),i=G(a.bids.priceSnap,a.bids.data),o=Math.max(z(r),z(i));return I.a(N.a(["asks","totals"],r),N.a(["asks","totalMax"],o),N.a(["bids","totalMax"],o),N.a(["bids","totals"],i))(s);case C.UPDATE_ASKS:var l=c,d=Object(A.a)(l,1)[0],b=g.a(String(d),W(c),a.asks.data),j=y.a(L.a(d),_.a,I.a(B.a([d]),u.a((function(a,t){return a-t}))))(a.asks.priceSnap),x=G(j,b),O=Math.max(z(x),a.bids.totalMax);return I.a(N.a(["asks","data"],b),N.a(["asks","priceSnap"],j),N.a(["asks","totals"],x),N.a(["asks","totalMax"],O))(a);case C.DELETE_ASKS:var v=c,p=Object(A.a)(v,1)[0],S=w.a(String(p),a.asks.data),h=P.a([p],a.asks.priceSnap),f=G(h,S),m=Math.max(z(f),a.bids.totalMax);return I.a(N.a(["asks","data"],S),N.a(["asks","priceSnap"],h),N.a(["asks","totals"],f),N.a(["asks","totalMax"],m))(a);case C.UPDATE_BIDS:var E=c,k=Object(A.a)(E,1)[0],M=g.a(String(k),W(c),a.bids.data),T=y.a(L.a(k),_.a,I.a(B.a([k]),u.a((function(a,t){return t-a}))))(a.bids.priceSnap),D=G(T,M),U=Math.max(z(D),a.asks.totalMax);return I.a(N.a(["bids","data"],M),N.a(["bids","priceSnap"],T),N.a(["bids","totals"],D),N.a(["bids","totalMax"],U))(a);case C.DELETE_BIDS:var K=c,F=Object(A.a)(K,1)[0],J=w.a(String(F),a.bids.data),R=P.a([F],a.bids.priceSnap),q=G(R,J),Q=Math.max(z(q),a.asks.totalMax);return I.a(N.a(["bids","data"],J),N.a(["bids","priceSnap"],R),N.a(["bids","totals"],q),N.a(["bids","totalMax"],Q))(a);default:return a}},X=function(){var a=localStorage.getItem("booksStore"),t=Object(c.useReducer)(V,a?JSON.parse(a):Q),e=Object(A.a)(t,2),n=e[0],s=e[1],r=Object(c.useCallback)((function(){return localStorage.setItem("booksStore",JSON.stringify(n))}),[n]);return Object(c.useEffect)((function(){var a=new WebSocket("wss://api-pub.bitfinex.com/ws/2"),t=0;return a.onopen=function(){a.send(JSON.stringify({event:"subscribe",channel:"book",symbol:"tBTCUSD"}))},a.onmessage=function(a){var e=a.data,n=JSON.parse(e);if(!n.event)if(n[1]&&n[1][0]&&Array.isArray(n[1][0]))s([C.INITIAL,n[1]]);else{var c=Object(A.a)(n[1],3),r=c[1],i=c[2];t+=1,r>0?setTimeout((function(){s([i>0?C.UPDATE_BIDS:C.UPDATE_ASKS,n[1]])}),200*t):setTimeout((function(){s([i>0?C.DELETE_BIDS:C.DELETE_ASKS,n[1]])}),100*t)}},window.addEventListener("unload",r,!1),function(){try{window.removeEventListener("unload",r,!1),a.close()}catch(t){console.error(t,"error in closing websocket")}}}),[]),n},Y=function(){var a=X();return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(o,{}),Object(n.jsx)(O.Provider,{value:a,children:Object(n.jsx)(D,{})})]})},Z=function(a){a&&a instanceof Function&&e.e(3).then(e.bind(null,57)).then((function(t){var e=t.getCLS,n=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;e(a),n(a),c(a),s(a),r(a)}))};i.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(Y,{})}),document.getElementById("root")),Z()}},[[42,1,2]]]);
//# sourceMappingURL=main.8b6b8d2b.chunk.js.map