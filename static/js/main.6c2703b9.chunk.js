(this["webpackJsonpreact-live-tracker"]=this["webpackJsonpreact-live-tracker"]||[]).push([[0],{27:function(t,a,e){},38:function(t,a,e){},39:function(t,a,e){},40:function(t,a,e){},41:function(t,a,e){},42:function(t,a,e){"use strict";e.r(a);var n=e(0),r=e(3),c=e.n(r),s=e(28),i=e.n(s),o=(e(38),e(27),e(39),function(){return Object(n.jsxs)("div",{className:"header",children:["Order Book"," ",Object(n.jsx)("span",{className:"subText",children:" BTC/USD"})]})}),l=e(9),d=e(22),u=e(43),b=e(45),j=e(32),S=e(29),x=Object(r.createContext)(null),O=function(){return Object(n.jsx)("svg",{width:"20px",height:"20px",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",style:{verticalAlign:"middle"},children:Object(n.jsx)("circle",{cx:"50",cy:"50",fill:"none",stroke:"#b7b7b7",strokeWidth:"10",r:"35",strokeDasharray:"164.93361431346415 56.97787143782138",transform:"rotate(229.847 50 50)",children:Object(n.jsx)("animateTransform",{attributeName:"transform",type:"rotate",calcMode:"linear",values:"0 50 50;360 50 50",keyTimes:"0;1",dur:"1.8s",begin:"0s",repeatCount:"indefinite"})})})},v=e(44),E=(e(40),c.a.memo((function(t){var a=t.value,e=t.totalMax,c=Object(d.a)(t,["value","totalMax"]),s=Object(r.useMemo)((function(){return"".concat(100*Math.abs(a)/e,"%")}),[a,e]);return Object(n.jsx)("rect",Object(l.a)(Object(l.a)({},c),{},{width:s}))}))),h=c.a.memo((function(t){var a=t.type,e=Object(r.useContext)(x)[a],c=e.totals,s=e.totalMax,i=Object(r.useMemo)((function(){return"bids"===a?u.a(v.a(j.a("total")),S.a(c)):S.a(c)}),[c,a]);return Object(n.jsx)("div",{className:"chart container",children:Object(n.jsx)("svg",{className:a,children:null===i||void 0===i?void 0:i.map((function(t,e){var r=t.total;return Object(n.jsx)(E,{x:"1",y:17*e,height:"17",value:r,totalMax:s,fillOpacity:"1"},"".concat(a,"-").concat(e))}))})})})),p=(e(41),function(t){var a=t.children;return Object(n.jsx)("div",{className:"tableBody",children:a})}),m=function(t){var a=t.children,e={"--ratio":t.ratio};return Object(n.jsx)("div",{className:"tableField",style:e,children:a})},f=function(t){var a=t.children;return Object(n.jsx)("div",{className:"tableHeader",children:a})},T=function(t){var a=t.children;return Object(n.jsx)("p",{className:"tableLabel",children:a})},k=function(t){var a=t.children;return Object(n.jsx)("div",{className:"tableRow",children:a})},g=c.a.memo((function(t){var a=t.item,e=t.total;return Object(n.jsxs)(k,{children:[Object(n.jsxs)(m,{children:[Object(n.jsx)(T,{children:"Count"}),null===a||void 0===a?void 0:a.count]}),Object(n.jsxs)(m,{children:[Object(n.jsx)(T,{children:"Amount"}),(null===a||void 0===a?void 0:a.amount)&&Math.abs(a.amount)]}),Object(n.jsxs)(m,{children:[Object(n.jsx)(T,{children:"Total"}),e&&Math.abs(e)]}),Object(n.jsxs)(m,{children:[Object(n.jsx)(T,{children:"Price"}),null===a||void 0===a?void 0:a.price]})]})})),D=c.a.memo((function(t){var a=t.type,e=Object(d.a)(t,["type"]),c=Object(r.useContext)(x),s=c[a],i=s.data,o=s.totals,v=Object(r.useMemo)((function(){return"bids"===a?u.a(b.a(j.a("price")),S.a(i)):S.a(i)}),[i,a]);return Object(n.jsxs)("div",Object(l.a)(Object(l.a)({className:"table ".concat(null!==a&&void 0!==a?a:"")},e),{},{children:[Object(n.jsx)(f,{children:Object(n.jsx)(g,{})}),Object(n.jsx)(p,{children:(null===c||void 0===c?void 0:c.loading)?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(O,{}),"Loading ..."]}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(h,{type:a}),v.map((function(t,e){var r;return Object(n.jsx)(g,{item:t,total:null===(r=o[t.price])||void 0===r?void 0:r.total},"".concat(a,"-").concat(e))}))]})})]}))})),M=function(){return Object(n.jsxs)("div",{className:"tableContainer",children:[Object(n.jsx)(D,{type:"bids"}),Object(n.jsx)(D,{type:"asks"})]})},A=e(8),_=e(52),I=e(54),U=e(31),R=e(47),y=e(48),N=e(55),C=e(51),w=e(49),L=e(56),B={INITIAL:"INITIAL",UPDATE_ASKS:"UPDATE_ASKS",DELETE_ASKS:"DELETE_ASKS",UPDATE_BIDS:"UPDATE_BIDS",DELETE_BIDS:"DELETE_BIDS",REQUEST_STARTED:"REQUEST_STARTED",REQUEST_SUCCESS:"REQUEST_SUCCESS",REQUEST_ERROR:"REQUEST_ERROR"},P=e(53),Q=e(46),F=e(50),K=e(23),J=e(30),W=e(20),H=P.a({price:Q.a(F.a(0)),count:Q.a(F.a(1)),amount:Q.a(F.a(2))}),Y=S.a,q=_.a(Y,K.a(j.a("total")),J.a(Math.max)),z=function(t,a){return t.reduce((function(t,e,n,r){void 0===t[e]&&(t[e]={});var c=a[e].amount,s=(t[r[n-1]]||{}).total,i=void 0===s?0:s;return t[e]={amount:c,total:parseFloat((i+c).toFixed(8))},t}),{})},G={asks:{data:{},priceSnap:[],totals:{},totalMax:0},bids:{data:{},priceSnap:[],totals:{},totalMax:0},loading:!1,error:null},V=function(t,a){var e=Object(A.a)(a,2),n=e[0],r=e[1];switch(n){case B.REQUEST_STARTED:return Object(l.a)(Object(l.a)({},t),{},{loading:!0,error:null});case B.REQUEST_SUCCESS:return Object(l.a)(Object(l.a)({},t),{},{loading:!1,error:null});case B.INITIAL:var c=function(t,a){return W.a((function(t,a){var e=Object(A.a)(a,3),n=e[0],r=e[2]>=0?"bids":"asks";return void 0===t[r].data[n]&&(t[r].data[n]={}),t[r].priceSnap.push(n),t[r].data[n]=H(a),t}),a,t)}(r,t),s=z(t.asks.priceSnap,t.asks.data),i=z(t.bids.priceSnap,t.bids.data),o=Math.max(q(s),q(i));return _.a(I.a(["asks","totals"],s),I.a(["asks","totalMax"],o),I.a(["bids","totalMax"],o),I.a(["bids","totals"],i))(c);case B.UPDATE_ASKS:var d=r,b=Object(A.a)(d,1)[0],j=U.a(String(b),H(r),t.asks.data),S=R.a(y.a(b),N.a,_.a(C.a([b]),u.a((function(t,a){return t-a}))))(t.asks.priceSnap),x=z(S,j),O=Math.max(q(x),t.bids.totalMax);return _.a(I.a(["asks","data"],j),I.a(["asks","priceSnap"],S),I.a(["asks","totals"],x),I.a(["asks","totalMax"],O))(t);case B.DELETE_ASKS:var v=r,E=Object(A.a)(v,1)[0],h=w.a(String(E),t.asks.data),p=L.a([E],t.asks.priceSnap),m=z(p,h),f=Math.max(q(m),t.bids.totalMax);return _.a(I.a(["asks","data"],h),I.a(["asks","priceSnap"],p),I.a(["asks","totals"],m),I.a(["asks","totalMax"],f))(t);case B.UPDATE_BIDS:var T=r,k=Object(A.a)(T,1)[0],g=U.a(String(k),H(r),t.bids.data),D=R.a(y.a(k),N.a,_.a(C.a([k]),u.a((function(t,a){return a-t}))))(t.bids.priceSnap),M=z(D,g),P=Math.max(q(M),t.asks.totalMax);return _.a(I.a(["bids","data"],g),I.a(["bids","priceSnap"],D),I.a(["bids","totals"],M),I.a(["bids","totalMax"],P))(t);case B.DELETE_BIDS:var Q=r,F=Object(A.a)(Q,1)[0],K=w.a(String(F),t.bids.data),J=L.a([F],t.bids.priceSnap),Y=z(J,K),G=Math.max(q(Y),t.asks.totalMax);return _.a(I.a(["bids","data"],K),I.a(["bids","priceSnap"],J),I.a(["bids","totals"],Y),I.a(["bids","totalMax"],G))(t);default:return t}},X=function(){var t=localStorage.getItem("booksStore"),a=Object(r.useReducer)(V,t?JSON.parse(t):G),e=Object(A.a)(a,2),n=e[0],c=e[1],s=Object(r.useCallback)((function(){return localStorage.setItem("booksStore",JSON.stringify(n))}),[n]);return Object(r.useEffect)((function(){var t=new WebSocket("wss://api-pub.bitfinex.com/ws/2"),a=0;return t.onopen=function(){c([B.REQUEST_STARTED,void 0]),t.send(JSON.stringify({event:"subscribe",channel:"book",symbol:"tBTCUSD"}))},t.onmessage=function(t){var e=t.data,n=JSON.parse(e);if(!n.event)if(n[1]&&n[1][0]&&Array.isArray(n[1][0]))c([B.REQUEST_SUCCESS,void 0]),c([B.INITIAL,n[1]]);else{var r=Object(A.a)(n[1],3),s=r[1],i=r[2];a+=1,s>0?setTimeout((function(){c([i>0?B.UPDATE_BIDS:B.UPDATE_ASKS,n[1]])}),200*a):setTimeout((function(){c([i>0?B.DELETE_BIDS:B.DELETE_ASKS,n[1]])}),100*a)}},window.addEventListener("unload",s,!1),function(){try{window.removeEventListener("unload",s,!1),t.close()}catch(a){console.error(a,"error in closing websocket")}}}),[]),n},Z=function(){var t=X();return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(o,{}),Object(n.jsx)(x.Provider,{value:t,children:Object(n.jsx)(M,{})})]})},$=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,57)).then((function(a){var e=a.getCLS,n=a.getFID,r=a.getFCP,c=a.getLCP,s=a.getTTFB;e(t),n(t),r(t),c(t),s(t)}))};i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(Z,{})}),document.getElementById("root")),$()}},[[42,1,2]]]);
//# sourceMappingURL=main.6c2703b9.chunk.js.map